<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>堆攻击IO_FILE on f1ow-blog</title><link>https://zp9080.github.io/categories/%E5%A0%86%E6%94%BB%E5%87%BBio_file/</link><description>Recent content in 堆攻击IO_FILE on f1ow-blog</description><generator>Hugo</generator><language>zh-CN</language><lastBuildDate>Mon, 04 Nov 2024 19:19:49 +0800</lastBuildDate><atom:link href="https://zp9080.github.io/categories/%E5%A0%86%E6%94%BB%E5%87%BBio_file/rss.xml" rel="self" type="application/rss+xml"/><item><title>libc2.27下的orw</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/libc2.27%E4%B8%8B%E7%9A%84orw/</link><pubDate>Mon, 04 Nov 2024 19:19:49 +0800</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/libc2.27%E4%B8%8B%E7%9A%84orw/</guid><description>&lt;p>
&lt;a href="https://blog.csdn.net/qq_45595732/article/details/115271623" title="参考文章" rel="noopener external nofollow noreferrer" target="_blank" class=" exturl">
 参考文章
 
 &lt;i class="fa fa-external-link-alt">&lt;/i>
 
&lt;/a>&lt;/p></description></item><item><title>libc2.27下的house of orange+house of apple2</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/libc2.27%E4%B8%8B%E7%9A%84house-of-orange+house-of-apple2/</link><pubDate>Sun, 22 Sep 2024 20:28:50 +0800</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/libc2.27%E4%B8%8B%E7%9A%84house-of-orange+house-of-apple2/</guid><description/></item><item><title>house of apple1</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-apple1/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-apple1/</guid><description>[TOC] 参考博客 house of apple1 需要和其他方法结合而进行后续的FSOP利用 _IO_wstrn_jumps 前言 利用条件 使用house of apple的条件为： 1、程序从main函数返回或能调</description></item><item><title>house of apple2</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-apple2/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-apple2/</guid><description>[TOC] 参考博客 house of apple2心得体会 house of apple2可以在只劫持_wide_data的条件下控制程序的执行流!!! fp的vtable覆盖为_I</description></item><item><title>house of cat</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-cat/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-cat/</guid><description>[TOC] 参考博客 参考博客 house of cat在_IO_switch_to_wget_mode可以设置rdx,随后调用setcontent+61可以直接进行o</description></item><item><title>house of emma</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-emma/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-emma/</guid><description>[TOC] 参考文章 例题详解 _IO_cookie_jumps中的_IO_cookie_write，_IO_cookie_write又会调用 cookie_io_functions_t __io_</description></item><item><title>house of kiwi</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-kiwi/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-kiwi/</guid><description>[TOC] 参考文章 例题讲解 例题讲解 _IO_file_jumps中的_IO_file_sync 前言 加沙盒的题目,在2.29之后的堆题中,通常为以下两种</description></item><item><title>house of orange</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-orange/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-orange/</guid><description>[TOC] 参考博客 攻击分析 修改top chunk的size，然后add一个大于top chunk size的chunk让top chunk进入unsorted bin</description></item><item><title>house of pig</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-pig/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-pig/</guid><description>[TOC] 原理详解 题目详解 _IO_str_jumps中的_IO_str_overflow 核心 利用_IO_str_overflow的malloc,me</description></item><item><title>house of pig plus</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-pig-plus/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/house-of-pig-plus/</guid><description>[TOC] 参考博客 当题目中限制了system函数的调用，可以使用此方法进行orw，但是这个方法的前提还是有hook可打 特别之处 IO_str_over</description></item><item><title>io basic knowledge</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/io-basic-knowledge/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/io-basic-knowledge/</guid><description>[TOC] _IO_list_all、 _IO_2_1_stderr、 stderr FSOP FSOP 是 File Stream Oriented Programming 的缩写，根据前面对 FILE 的介绍得知进程内所有的_IO_FILE 结构会使</description></item><item><title>largebin attack</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/largebin-attack/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/largebin-attack/</guid><description>[TOC] 学习时参考的博客 博客1 博客2 往一个地址写入一个堆地址 largebin attack经常用来在堆上伪造FAKE FILE来打IO_FILE 代码 malloc(0x420) #0 malloc(0x20) malloc(0x410) #1 malloc(0x20) free(0) #</description></item><item><title>libc got</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/libc-got/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/libc-got/</guid><description>[TOC] 参考博客 其实没什么特别的，现在主流的打法就是puts函数会调用libc中got.plt的strlen函数，而strlen的got表可以被我</description></item><item><title>libc2.39堆攻击</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/libc2.39%E5%A0%86%E6%94%BB%E5%87%BB/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/libc2.39%E5%A0%86%E6%94%BB%E5%87%BB/</guid><description>打litctf2024的时候遇到了一个libc2.39的堆，还是用house of apple2这个链打，但是有一点不同，这里做一下记录 主要是发现</description></item><item><title>magic gadgets</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/magic-gadgets/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/magic-gadgets/</guid><description>libc2.36 此时的rax正好指向FAKE_IO头部 .text:0000000000160E56 mov rdx, [rax+38h] .text:0000000000160E5A mov rdi, rax .text:0000000000160E5D call qword ptr [rdx+20h] 也就是svcudp_reply+0x1a .text:00000000001630AA mov rbp, [rdi+48h] .text:00000000001630AE mov rax, [rbp+18h] .text:00000000001630B2 lea r13, [rbp+10h] .text:00000000001630B6 mov dword ptr [rbp+10h],</description></item><item><title>stderr</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/stderr/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/stderr/</guid><description>在打IO攻击的时候经常需要用到malloc_assert，要打stderr,这里区分一下几个概念 1.直接打_IO_2_1_stderr_ 如果</description></item><item><title>stdout</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/stdout/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/stdout/</guid><description>[TOC] 遇到puts或printf，就会将_IO_write_base指向的内容打印出来。实际操作中发现如果是write函数还不行 stdout原理</description></item><item><title>堆summary</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/%E5%A0%86summary/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/%E5%A0%86summary/</guid><description>[TOC] house系列 house系列的致命缺陷就是vtable是通过偏移调用函数 这种找vtable要根据源码去libc.so.6里面进行对比查找，</description></item><item><title>最常用的house攻击</title><link>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84house%E6%94%BB%E5%87%BB/</link><pubDate>Sun, 28 Jul 2024 00:00:00 +0000</pubDate><guid>https://zp9080.github.io/post/%E5%A0%86%E6%94%BB%E5%87%BBio_file/%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84house%E6%94%BB%E5%87%BB/</guid><description>[TOC] 经验总结 _IO_list_all,IO_2_1_stderr,stderr看情况写哪个 FROP打house of apple2,malloc_a</description></item></channel></rss>